{% extends 'base.html.twig' %}

{% block title %}Liste des avis
{% endblock %}

{% block body %}
	<div class="max-w-3xl mx-auto mt-10">
		<h1 class="text-2xl font-bold mb-4">Tous les avis</h1>

		<a href="{{ path('review_new') }}" class="inline-block mb-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
			+ Ajouter un avis
		</a>

		{% for review in reviews %}
			<div class="mb-6 p-4 bg-white border rounded shadow">
				<h2 class="text-lg font-semibold">
					{{ review.mangaAnimes.title ?? 'Anime inconnu' }}
				</h2>
				<p class="text-sm text-gray-700">
					Note :
					<strong>{{ review.rating }}/5</strong>
					<span class="ml-2">Par
						{{ review.users.email }}</span>
				</p>
				<p class="mt-2">{{ review.content | e }}</p>
				<div class="mt-3 flex space-x-2">
					<a href="{{ path('review_show', { id: review.id }) }}" class="text-blue-500 hover:underline text-sm">Voir</a>
					{% if app.user and (app.user == review.users or is_granted('ROLE_ADMIN')) %}
						<a href="{{ path('review_edit', { id: review.id }) }}" class="text-green-500 hover:underline text-sm">Modifier</a>
						<form method="post" action="{{ path('review_delete', { id: review.id }) }}" onsubmit="return confirm('Confirmer la suppression ?');" class="inline">
							<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ review.id) }}">
							<button class="text-red-500 text-sm">Supprimer</button>
						</form>
					{% endif %}
				</div>
			</div>
		{% else %}
			<p>Aucun avis pour lâ€™instant.</p>
		{% endfor %}
	</div>
{% endblock %}
