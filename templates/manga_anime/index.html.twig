{# templates/manga_anime/index.html.twig #}

{% extends 'base.html.twig' %}

{% block title %}Catalogue Manga/Anime
{% endblock %}

{% block body %}
	<style>
		.scrollbar-hide::-webkit-scrollbar {
			display: none;
		}
		.scrollbar-hide {
			-ms-overflow-style: none;
			scrollbar-width: none;
		}
	</style>
	<div class="mb-8"></div>
	<div class="mb-8 relative">
		<h2 class="text-2xl font-bold mb-4 pb-2 border-b border-gray-800">Les plus populaires</h2>
		<button id="scroll-left" aria-label="Scroll gauche" class="absolute left-0 top-1/2 -translate-y-1/2 bg-transparent p-2 rounded-full shadow z-10 hover:bg-gray-100">
			{{ ux_icon('flowbite:angle-left-outline', {class: 'w-6 h-6'}) }}
		</button>
		<button id="scroll-right" aria-label="Scroll droite" class="absolute right-0 top-1/2 -translate-y-1/2 bg-transparent p-2 rounded-full shadow z-10 hover:bg-gray-100">
			{{ ux_icon('flowbite:angle-right-outline', {class: 'w-6 h-6'}) }}
		</button>
		<div id="scroll-container" class="overflow-x-auto scrollbar-hide">
			<div class="flex space-x-6">
				{% set populaires = mangaAnimes|sort((a, b) => b.popularity <=> a.popularity) %}
				{% for manga in populaires %}
					<div class="bg-black rounded-lg shadow-md overflow-hidden transform hover:scale-105 transition flex-shrink-0 w-64">
						<img src="{{ asset('medias/images/' ~ manga.image) }}" alt="{{ manga.title }}" class="w-full h-64 object-contain bg-gray-100">
						<div class="p-4 text-center">
							<h3 class="text-lg font-semibold mb-1">{{ manga.title|upper }}</h3>
							<p class="text-gray-500 text-sm">{{ manga.type|capitalize }}</p>
							{# Formulaire pour ajouter aux favoris #}
							<form action="{{ path('favori_add', { mangaAnimeId: manga.id }) }}" method="post" class="mx-4 my-2">
								<button type="submit" class="w-full px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition">
									❤️ Ajouter aux Favoris
								</button>
							</form>
						</div>
					</div>
				{% endfor %}
			</div>
		</div>
	</div>
	{# Section des classiques #}
	<div class="mb-8 relative">
		<h2 class="text-2xl font-bold mb-4 pb-2 border-b border-gray-800">Les classiques</h2>
		<button id="scroll-left-classic" aria-label="Scroll gauche" class="absolute left-0 top-1/2 -translate-y-1/2 bg-transparent p-2 rounded-full shadow z-10 hover:bg-gray-100">
			{{ ux_icon('flowbite:angle-left-outline', {class: 'w-6 h-6'}) }}
		</button>
		<button id="scroll-right-classic" aria-label="Scroll droite" class="absolute right-0 top-1/2 -translate-y-1/2 bg-transparent p-2 rounded-full shadow z-10 hover:bg-gray-100">
			{{ ux_icon('flowbite:angle-right-outline', {class: 'w-6 h-6'}) }}
		</button>
		<div id="scroll-container-classic" class="overflow-x-auto scrollbar-hide">
			<div class="flex space-x-6">
				{% set classiques = mangaAnimes|filter(m => m.releaseDate < date('2000-01-01')) %}
				{% for manga in classiques %}
					<div class="bg-black rounded-lg shadow-md overflow-hidden transform hover:scale-105 transition flex-shrink-0 w-64">
						<img src="{{ asset('medias/images/' ~ manga.image) }}" alt="{{ manga.title }}" class="w-full h-64 object-contain bg-gray-100">
						<div class="p-4 text-center">
							<h3 class="text-lg font-semibold mb-1">{{ manga.title|upper }}</h3>
							<p class="text-gray-500 text-sm">{{ manga.type|capitalize }}</p>
						</div>
					</div>
				{% endfor %}
			</div>
		</div>
	</div>

	{# Section des nouveautés #}
	<div class="mb-8 relative">
		<h2 class="text-2xl font-bold mb-4 pb-2 border-b border-gray-800">Nouveau</h2>
		<button id="scroll-left-new" aria-label="Scroll gauche" class="absolute left-0 top-1/2 -translate-y-1/2 bg-transparent p-2 rounded-full shadow z-10 hover:bg-gray-100">
			{{ ux_icon('flowbite:angle-left-outline', {class: 'w-6 h-6'}) }}
		</button>
		<button id="scroll-right-new" aria-label="Scroll droite" class="absolute right-0 top-1/2 -translate-y-1/2 bg-transparent p-2 rounded-full shadow z-10 hover:bg-gray-100">
			{{ ux_icon('flowbite:angle-right-outline', {class: 'w-6 h-6'}) }}
		</button>
		<div id="scroll-container-new" class="overflow-x-auto scrollbar-hide">
			<div class="flex space-x-6">
				{% set nouveaux = mangaAnimes|filter(m => m.releaseDate > date('2025-01-01')) %}
				{% for manga in nouveaux %}
					<div class="bg-black rounded-lg shadow-md overflow-hidden transform hover:scale-105 transition flex-shrink-0 w-64">
						<img src="{{ asset('medias/images/' ~ manga.image) }}" alt="{{ manga.title }}" class="w-full h-64 object-contain bg-gray-100">
						<div class="p-4 text-center">
							<h3 class="text-lg font-semibold mb-1">{{ manga.title|upper }}</h3>
							<p class="text-gray-500 text-sm">{{ manga.type|capitalize }}</p>
						</div>
						<a href="{{ path('mangaAnime_view', { id: manga.id }) }}" class="block mx-4 my-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700 text-center transition">
							Voir Détails
						</a>
					</div>
				{% endfor %}
			</div>
		</div>
	</div>

	{# Section Monstre & Démon #}
	<div class="mb-8 relative">
		<h2 class="text-2xl font-bold mb-4 pb-2 border-b border-gray-800">Monstre & Démon</h2>
		<button id="scroll-left-md" aria-label="Scroll gauche" class="absolute left-0 top-1/2 -translate-y-1/2 bg-transparent p-2 rounded-full shadow z-10 hover:bg-gray-100">
			{{ ux_icon('flowbite:angle-left-outline', {class: 'w-6 h-6'}) }}
		</button>
		<button id="scroll-right-md" aria-label="Scroll droite" class="absolute right-0 top-1/2 -translate-y-1/2 bg-transparent p-2 rounded-full shadow z-10 hover:bg-gray-100">
			{{ ux_icon('flowbite:angle-right-outline', {class: 'w-6 h-6'}) }}
		</button>
		<div id="scroll-container-md" class="overflow-x-auto scrollbar-hide">
			<div class="flex space-x-6">
				{% set monstres = mangaAnimes|filter(m =>
                    m.genre matches '/monstre/i' or 
                    m.genre matches '/démon/i' or 
                    m.genre matches '/demon/i' or
                    m.genre matches '/horreur/i' or
                    m.title matches '/demon/i'
                ) %}
				{% for manga in monstres %}
					<div class="bg-black rounded-lg shadow-md overflow-hidden transform hover:scale-105 transition flex-shrink-0 w-64">
						<img src="{{ asset('medias/images/' ~ manga.image) }}" alt="{{ manga.title }}" class="w-full h-64 object-contain bg-gray-100">
						<div class="p-4 text-center">
							<h3 class="text-lg font-semibold mb-1">{{ manga.title|upper }}</h3>
							<p class="text-gray-500 text-sm">{{ manga.type|capitalize }}</p>
						</div>
					</div>
				{% endfor %}
			</div>
		</div>
	</div>
{% endblock %}
